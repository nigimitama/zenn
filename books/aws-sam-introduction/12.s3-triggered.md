---
title: "例：S3トリガーのLambda"
---

# 本章でつくるもの

- S3 バケット
- S3 バケット にファイルが登録されることをトリガーとして起動する Lambda

を作っていきます。

# template.yaml の例

```yaml
AWSTemplateFormatVersion: "2010-09-09"
Transform: AWS::Serverless-2016-10-31

Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: my-trigger-bucket

  MyContainerFunction:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: my-s3-trigger-function
      PackageType: Image
      Architectures:
        - x86_64
      Events:
        # S3バケットに.txtファイルが作成されたらトリガーされるイベント
        S3UploadEvent:
          Type: S3
          Properties:
            Bucket: !Ref MyBucket
            Events: s3:ObjectCreated:*
            Filter:
              S3Key:
                Rules:
                  - Name: suffix
                    Value: .txt # 必要に応じて拡張子などでフィルターできる
    Metadata:
      Dockerfile: Dockerfile
      DockerContext: ./src
      DockerTag: python3.12-v1

Outputs:
  BucketName:
    Description: Name of the S3 bucket
    Value: !Ref MyBucket

  FunctionName:
    Description: Name of the Lambda function
    Value: !Ref MyContainerFunction
```

（後で Dockerfile など全体を追記します）
